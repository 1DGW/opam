Proof of Stalmarck's algorithm.